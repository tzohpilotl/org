<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Unit Tests In React | Notes On Programming</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Unit Tests In React" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Table of Contents" />
<meta property="og:description" content="Table of Contents" />
<link rel="canonical" href="http://localhost:4000/2022/03/10/unit-tests-in-react.html" />
<meta property="og:url" content="http://localhost:4000/2022/03/10/unit-tests-in-react.html" />
<meta property="og:site_name" content="Notes On Programming" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-03-10T00:00:00-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Unit Tests In React" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-03-10T00:00:00-06:00","datePublished":"2022-03-10T00:00:00-06:00","description":"Table of Contents","headline":"Unit Tests In React","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2022/03/10/unit-tests-in-react.html"},"url":"http://localhost:4000/2022/03/10/unit-tests-in-react.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Notes On Programming" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Notes On Programming</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Unit Tests In React</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2022-03-10T00:00:00-06:00" itemprop="datePublished">Mar 10, 2022
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h1 id="table-of-contents">Table of Contents</h1>

<ol>
  <li><a href="#org39c2ac9">Context</a></li>
  <li><a href="#orgdbe1ef2">Unit Tests Scope In React</a></li>
  <li><a href="#org45820bd">Testing State vs Testing Outcomes</a></li>
  <li><a href="#orge8b32da">When To Test The Redux <code class="language-plaintext highlighter-rouge">connect</code> HOC</a></li>
  <li><a href="#org6ae15a5">How To Test React Components</a></li>
  <li><a href="#orge927f27">QA</a></li>
</ol>

<p><a id="org39c2ac9"></a></p>

<h1 id="context">Context</h1>

<h2 id="unit-tests-benefits">Unit Tests Benefits</h2>

<ul>
  <li>Ensure code correctness at the lowest level</li>
  <li>Prevents bug regressions</li>
  <li>Makes code coverage look cool 😎</li>
</ul>

<div class="NOTES" id="org138d32d">
<p>
Unit testing is the first tool programmers have to ensure the correctness of
their programs.
</p>

</div>

<h2 id="unit-tests-definition">Unit Tests Definition</h2>

<p>What makes a unit test a unit test is its scope:</p>

<p>Unit tests should only test one unit a time.</p>

<div class="NOTES" id="org1f5d29c">
<p>
A unit is a diffuse term but it usually refers to a function or a class. A good
unit test proves the outcome of the unit under test is correct for all it's
logic branches, and for the relevant inputs. Fortunately, reaping the benefits
of unit testing is not hard because the latest developments in technology make
writing unit tests easy.
</p>

</div>

<p><a id="orgdbe1ef2"></a></p>

<h1 id="unit-tests-scope-in-react">Unit Tests Scope In React</h1>

<ul>
  <li>Keep in mind the React component ultimate purpose: to generate HTML code</li>
  <li>A component is a unit</li>
</ul>

<div class="NOTES" id="orgdc28244">
<p>
As in every kind application, React apps benefit from having unit tests, but
they come with their own set of complications. What's generally accepted though,
is that a React component, especially if it's simple as in markup-only
components, but even if it's complex, with state management, children, and
network calls, is an unit. With the exception of higher-order-components,
something we should always keep in mind while testing is a component's
fundamental <i>purpose</i>: to generate HTML code. This means that all that state
handling, network calling, and children bearing, will ultimately result in a
tree of HTML tags ready to be rendered by the browser.
</p>

</div>

<p><a id="org45820bd"></a></p>

<h1 id="testing-state-vs-testing-outcomes">Testing State vs Testing Outcomes</h1>

<p>When developing unit tests there are two common approaches:
Testing state and testing outcomes.</p>

<h2 id="testing-a-units-state">Testing A Unit’s State</h2>

<p>Testing state is the practice of querying the state of the unit at a given
moment of time. In React, this can be seen in tests that assert the props and/or
the state of the component is what we expect it to be at interesting points in
time, for example, when a component is rendered for the first time, or when a
button has been clicked.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">assert</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">assert/strict</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">createCounter</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="na">count</span><span class="p">:</span> <span class="mi">0</span> <span class="p">};</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="nx">state</span><span class="p">,</span>
        <span class="nx">onClick</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">state</span><span class="p">.</span><span class="nx">count</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">},</span>
        <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s2">`&lt;p&gt;Clicked </span><span class="p">${</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span><span class="p">}</span><span class="s2">&lt;/p&gt;`</span><span class="p">;</span>
        <span class="p">},</span>
    <span class="p">};</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">counter</span> <span class="o">=</span> <span class="nx">createCounter</span><span class="p">();</span>

<span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">counter</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

<span class="nx">counter</span><span class="p">.</span><span class="nx">onClick</span><span class="p">();</span>

<span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">counter</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</code></pre></div></div>

<div class="NOTES" id="orgfac2f61">
<p>
My guess is we do this because when we debug we usually make sure the state is
correct step by step during the execution of our program.
</p>

<p>
What happens if we change the type of <code>state.count</code>?
What happens if we change <code>state.count</code> for <code>state.clicks</code>?
What happens if we pass the count as parameter (prop) instead of storing it as
state?
What happens if we change the word "Clicked" for "Clidkec" in the render method?
</p>

</div>

<h2 id="testing-a-units-purpose">Testing A Unit’s Purpose</h2>

<p>Testing outcomes refers to the practice of testing a unit delivers the outcomes
it’s designed to deliver. In React, this means we should test a component
delivers the desired HTML code given a known context.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">assert</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">assert/strict</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">createCounter</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="na">count</span><span class="p">:</span> <span class="mi">0</span> <span class="p">};</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="nx">state</span><span class="p">,</span>
        <span class="nx">onClick</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">state</span><span class="p">.</span><span class="nx">count</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">},</span>
        <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s2">`&lt;p&gt;Clicked </span><span class="p">${</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span><span class="p">}</span><span class="s2">&lt;/p&gt;`</span><span class="p">;</span>
        <span class="p">},</span>
    <span class="p">};</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">getInnerText</span><span class="p">(</span><span class="nx">html</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">html</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/</span><span class="se">\&lt;</span><span class="sr">p</span><span class="se">\&gt;</span><span class="sr">|</span><span class="se">\&lt;\/</span><span class="sr">p</span><span class="se">\&gt;</span><span class="sr">/gi</span><span class="p">,</span> <span class="dl">''</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">counter</span> <span class="o">=</span> <span class="nx">createCounter</span><span class="p">();</span>

<span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">getInnerText</span><span class="p">(</span><span class="nx">counter</span><span class="p">.</span><span class="nx">render</span><span class="p">()),</span> <span class="s2">`Clicked 0`</span><span class="p">);</span>

<span class="nx">counter</span><span class="p">.</span><span class="nx">onClick</span><span class="p">();</span>

<span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">getInnerText</span><span class="p">(</span><span class="nx">counter</span><span class="p">.</span><span class="nx">render</span><span class="p">()),</span> <span class="s2">`Clicked 1`</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="test-value">Test Value</h2>

<p>The value of a test has to be proposed case by case, it depends on the unit’s
purpose.</p>

<p>Let’s examine the <code class="language-plaintext highlighter-rouge">counter</code> component.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">createCounter</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="na">count</span><span class="p">:</span> <span class="mi">0</span> <span class="p">};</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="nx">state</span><span class="p">,</span>
        <span class="nx">onClick</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">state</span><span class="p">.</span><span class="nx">count</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">},</span>
        <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s2">`&lt;p&gt;Clicked </span><span class="p">${</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span><span class="p">}</span><span class="s2">&lt;/p&gt;`</span><span class="p">;</span>
        <span class="p">},</span>
    <span class="p">};</span>
<span class="p">}</span>
</code></pre></div></div>

<p>From the source code, we can tell that the counter component’s output is some
HTML code that includes the number of times its <code class="language-plaintext highlighter-rouge">onClick</code> callback has been
called, but in the end, the component’s expected <em>outcome</em> is this:</p>

<p>to show a user how many times the counter has been clicked.</p>

<p>Note that neither the fact that the counter comes from state or props, nor if
the text is displayed inside a paragraph or a list item matters to the end user.</p>

<h2 id="test-robustness">Test Robustness</h2>

<p>For every testing approach (testing a unit’s state and testing a unit’s
purpose), ask the following questions:</p>

<ul>
  <li>What happens if we change the type of <code class="language-plaintext highlighter-rouge">state.count</code>?</li>
  <li>What happens if we change <code class="language-plaintext highlighter-rouge">state.count</code> for <code class="language-plaintext highlighter-rouge">state.clicks</code>?</li>
  <li>What happens if we pass the count as parameter (prop) instead of storing it as state?</li>
  <li>What happens if we change the word “Clicked” for “Clidkec” in the render method?</li>
</ul>

<p>In general, test robustness increases when we test outcomes instead of state.</p>

<p><a id="orge8b32da"></a></p>

<h1 id="when-to-test-the-redux-connect-hoc">When To Test The Redux <code class="language-plaintext highlighter-rouge">connect</code> HOC</h1>

<h2 id="abstract-test-value">Abstract Test Value</h2>

<h3 id="does-it-render">Does it render?</h3>

<h3 id="does-it-generate-the-desired-props">Does it generate the desired <code class="language-plaintext highlighter-rouge">props</code>?</h3>

<h2 id="testing-the-mapstatetoprops-function">Testing the <code class="language-plaintext highlighter-rouge">mapStateToProps</code> function</h2>

<p><a id="org6ae15a5"></a></p>

<h1 id="how-to-test-react-components">How To Test React Components</h1>

<h2 id="abstract-test-value-1">Abstract Test Value</h2>

<h3 id="does-it-render-1">Does it render?</h3>

<h3 id="does-it-generate-the-desired-html">Does it generate the desired HTML?</h3>

<h2 id="testing-the-outcomes">Testing The Outcomes</h2>

<h1 id="final-words">Final Words</h1>

<p><a id="orge927f27"></a></p>

<h1 id="qa">QA</h1>


  </div><a class="u-url" href="/2022/03/10/unit-tests-in-react.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Notes On Programming</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Notes On Programming</li><li><a class="u-email" href="mailto:tzohpilotl@gmail.com">tzohpilotl@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/tzohpilotl"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">tzohpilotl</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
